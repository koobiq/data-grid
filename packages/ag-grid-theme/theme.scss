@use 'ag-grid-community/styles' as ag;

@include ag.grid-styles(
    (
        // Full AG Grid variables list:
        // https://www.ag-grid.com/archive/30.2.0/angular-data-grid/global-style-customisation-variables/
        theme: koobiq,
        --ag-foreground-color: var(--kbq-foreground-contrast-secondary),
        --ag-secondary-border-color: transparent,
        --ag-tooltip-background-color: var(--kbq-tooltip-contrast-fade-off-background),
        --ag-odd-row-background-color: var(--ag-background-color),
        --ag-control-panel-background-color: var(--ag-background-color),
        --ag-subheader-background-color: var(--ag-header-background-color),
        --ag-invalid-color: var(--kbq-error-default),
        --ag-secondary-foreground-color: var(--ag-foreground-color),
        --ag-disabled-foreground-color: var(--kbq-states-foreground-disabled),
        --ag-chip-background-color: rgba(24, 29, 31, 0.07),
        --ag-side-button-selected-background-color: transparent,
        --ag-grid-size: var(--kbq-size-s),
        --ag-list-item-height: calc(var(--ag-grid-size) * 4),
        --ag-set-filter-indent-size: var(--ag-icon-size),
        --ag-advanced-filter-builder-indent-size: calc(var(--ag-icon-size) + var(--ag-grid-size) * 2),
        --ag-tab-min-width: 240px,
        --ag-card-shadow: var(--kbq-shadow-popup),
        --ag-popup-shadow: var(--ag-card-shadow),
        --ag-side-bar-panel-width: 250px,
        --kbq-background-card: var(--kbq-background-card),
        --ag-data-color: var(--kbq-foreground-contrast),
        // Cell
        --ag-cell-horizontal-padding: var(--ag-grid-size),
        --ag-cell-widget-spacing: calc(var(--ag-grid-size) * 2),
        // Icon
        // @TODO Should be refactored, by adding css variables to the font-family and icon unicode names (#DS-3601)
        --ag-icon-font-family: 'Koobiq Icons',
        --ag-icon-size: var(--kbq-size-l),
        --ag-icon-font-code-aggregation: '\f572',
        --ag-icon-font-code-arrows: '',
        --ag-icon-font-code-paste: '',
        // @TODO Should use svg icon instead
        --ag-icon-font-code-checkbox-checked: '\f533',
        --ag-icon-font-code-checkbox-indeterminate: '',
        --ag-icon-font-code-checkbox-unchecked: '',
        --ag-icon-font-code-color-picker: '',
        --ag-icon-font-code-radio-button-off: '',
        --ag-icon-font-code-radio-button-on: '',
        --ag-icon-font-code-asc: '\f5d0',
        --ag-icon-font-code-cancel: '\f664',
        --ag-icon-font-code-chart: '\f763',
        --ag-icon-font-code-columns: '\f7d2',
        --ag-icon-font-code-contracted: '\f5b8',
        --ag-icon-font-code-copy: '\f67d',
        --ag-icon-font-code-cross: '\f664',
        --ag-icon-font-code-csv: '\f6c6',
        --ag-icon-font-code-cut: '\f58f',
        --ag-icon-font-code-desc: '\f5cd',
        --ag-icon-font-code-excel: '\f6c6',
        --ag-icon-font-code-expanded: '\f5b8',
        --ag-icon-font-code-eye-slash: '\f5d3',
        --ag-icon-font-code-eye: '\f5d2',
        --ag-icon-font-code-filter: '\f571',
        --ag-icon-font-code-first: '\f56c',
        --ag-icon-font-code-grip: '\f79e',
        --ag-icon-font-code-group: '\f53c',
        --ag-icon-font-code-last: '\f56d',
        --ag-icon-font-code-loading: '\f540',
        --ag-icon-font-code-linked: '\f573',
        --ag-icon-font-code-maximize: '\f5d0',
        --ag-icon-font-code-menu: '\f5ea',
        --ag-icon-font-code-minimize: '\f5f3',
        --ag-icon-font-code-next: '\f5b8',
        --ag-icon-font-code-none: '\f7f7',
        --ag-icon-font-code-not-allowed: '\f535',
        --ag-icon-font-code-pin: '\f671',
        --ag-icon-font-code-pivot: '\f7d2',
        --ag-icon-font-code-previous: '\f5d0',
        --ag-icon-font-code-left: '\f5b4',
        --ag-icon-font-code-right: '\f5b8',
        --ag-icon-font-code-minus: '\f5c7',
        --ag-icon-font-code-plus: '\f5f5',
        --ag-icon-font-code-down: '\f641',
        --ag-icon-font-code-up: '\f5eb',
        --ag-icon-font-code-unlinked: '\f57c',
        --ag-icon-font-code-tree-open: '\f5cb',
        --ag-icon-font-code-tree-indeterminate: '\f7b5',
        --ag-icon-font-code-tree-closed: '\f5b8',
        --ag-icon-font-code-tick: '\f679',
        --ag-icon-font-code-small-up: '\f5cd',
        --ag-icon-font-code-small-right: '\f5b8',
        --ag-icon-font-code-small-left: '\f5ce',
        --ag-icon-font-code-small-down: '\f5cd',
        --ag-icon-font-code-save: '\f554',
        // Column
        --ag-column-hover-color: var(--kbq-states-background-transparent-hover),
        --ag-column-select-indent-size: var(--ag-icon-size),
        // Header
        --ag-header-background-color: var(--ag-background-color),
        --ag-header-height: var(--kbq-size-4xl),
        --ag-header-foreground-color: var(--ag-foreground-color),
        // Selected tab
        --ag-selected-tab-underline-color: var(--ag-koobiq-active-color),
        --ag-selected-tab-underline-width: 2px,
        --ag-selected-tab-underline-transition-speed: 0.3s,
        // Row
        --ag-row-height: var(--kbq-size-4xl),
        --ag-row-hover-color: transparent,
        --ag-selected-row-background-color: transparent,
        // Border
        --ag-border-color: transparent,
        --ag-border-radius: var(--kbq-size-border-radius),
        // Borders
        --ag-borders: solid var(--kbq-size-border-width),
        --ag-borders-side-button: none,
        // Font
        --ag-font-family: var(--kbq-font-family-base),
        --ag-font-size: var(--kbq-typography-text-normal-font-size),
        // Toggle button
        --ag-toggle-button-height: 18px,
        --ag-toggle-button-width: 28px,
        // Checkbox
        --ag-checkbox-unchecked-color: var(--kbq-line-contrast-fade),
        --ag-checkbox-background-color: var(--kbq-icon-white),
        --ag-checkbox-checked-color: var(--ag-koobiq-active-color),
        --ag-checkbox-border-radius: var(--kbq-checkbox-size-normal-border-radius),
        --ag-checkbox-indeterminate-color: var(--ag-koobiq-active-color),
        // Widget
        --ag-widget-container-vertical-padding: calc(var(--ag-grid-size) * 2),
        --ag-widget-container-horizontal-padding: calc(var(--ag-grid-size) * 2),
        --ag-widget-vertical-spacing: calc(var(--ag-grid-size) * 1.5),
        // Input
        --ag-input-focus-border-color: var(--kbq-form-field-states-focused-border-color),
        --ag-input-border-color: var(--kbq-line-contrast-fade),
        --ag-input-border-color-invalid: var(--kbq-form-field-states-error-border-color),
        --ag-input-focus-box-shadow: 0 0 0.1px 1px var(--kbq-form-field-states-focused-border-color),
        --ag-input-disabled-border-color: var(--kbq-form-field-states-disabled-border-color),
        --ag-input-disabled-background-color: var(--kbq-form-field-states-disabled-background),
        // Header column resize
        --ag-header-column-resize-handle-display: block,
        --ag-header-column-resize-handle-width: var(--kbq-size-border-width),
        --ag-header-column-resize-handle-height: var(--kbq-size-l),
        --ag-header-column-resize-handle-color: var(--kbq-line-contrast-fade),
        // Range selection
        --ag-range-selection-background-color: rgba(33, 150, 243, 0.2),
        --ag-range-selection-background-color-2: rgba(33, 150, 243, 0.36),
        --ag-range-selection-background-color-3: rgba(33, 150, 243, 0.49),
        --ag-range-selection-background-color-4: rgba(33, 150, 243, 0.59),
        --ag-range-selection-border-color: var(--kbq-states-line-focus-theme)
    )
);

.ag-theme-koobiq {
    // @TODO Should resolve - `[ERROR] $color: var(--kbq-background-bg) is not a color.`, when using for `ag.grid-styles`
    --ag-background-color: var(--kbq-background-bg);
    --ag-koobiq-active-color: var(--kbq-background-theme);
    --ag-koobiq-row-background-color: var(--ag-background-color);

    line-height: var(--kbq-typography-text-normal-line-height);
    letter-spacing: var(--kbq-typography-text-normal-letter-spacing);
    font-weight: var(--kbq-typography-text-normal-font-weight);

    .ag-tooltip {
        --ag-foreground-color: var(--kbq-tooltip-contrast-fade-off-text);

        box-shadow: var(--kbq-tooltip-contrast-fade-off-shadow);
        font-size: var(--kbq-typography-text-compact-font-size);
        line-height: var(--kbq-typography-text-compact-line-height);
    }

    .ag-header-row .ag-header-cell-resize {
        opacity: 0;
        transition: opacity 0.2s;
    }

    .ag-header-row:hover .ag-header-cell-resize {
        opacity: 1;
    }

    .ag-header-row .ag-header-cell-resize::after {
        border-radius: 3px;
    }

    .ag-header-row .ag-header-cell-resize:hover {
        --ag-header-column-resize-handle-width: 2px;
        --ag-header-column-resize-handle-height: 20px;
        --ag-header-column-resize-handle-color: var(--ag-koobiq-active-color);
    }

    .ag-header,
    .ag-advanced-filter-header {
        border-bottom: var(--kbq-size-border-width) solid var(--kbq-line-contrast-less);
    }

    .ag-filter-toolpanel-header,
    .ag-filter-toolpanel-search,
    .ag-status-bar,
    .ag-header-row,
    .ag-panel-title-bar-title,
    .ag-multi-filter-group-title-bar {
        color: var(--ag-header-foreground-color);
    }

    @include ag.text-input {
        min-height: calc(var(--ag-grid-size) * 4);
        border-radius: var(--ag-border-radius);
        padding: var(--kbq-size-xs) var(--kbq-size-m);
    }

    .ag-cell,
    .ag-full-width-row .ag-cell-wrapper.ag-row-group {
        padding-left: var(--ag-cell-horizontal-padding);
        padding-right: var(--ag-cell-horizontal-padding);
    }

    .ag-header-cell:first-child,
    .ag-cell:first-child {
        padding-left: calc(var(--ag-cell-horizontal-padding) + var(--kbq-size-s));
    }

    .ag-header-cell:last-child,
    .ag-cell:last-child {
        padding-right: calc(var(--ag-cell-horizontal-padding) + var(--kbq-size-s));
    }

    .ag-row {
        background-color: var(--ag-koobiq-row-background-color);
        border-bottom: none;
        // @TODO add border-radius
        // border-radius: var(--ag-border-radius);

        &::before {
            background: none;
        }
    }

    .ag-row:not(.ag-row-focus),
    .ag-row:not(.ag-row-selected) {
        &:hover {
            --ag-koobiq-row-background-color: var(--kbq-states-background-transparent-hover);
        }

        &:active {
            --ag-koobiq-row-background-color: var(--kbq-states-background-transparent-active);
        }
    }

    .ag-row.ag-row-selected:not(.ag-row-focus) {
        --ag-koobiq-row-background-color: var(--kbq-background-contrast-less);

        &:hover {
            --ag-koobiq-row-background-color: var(--kbq-states-background-contrast-less-hover);
        }

        &:active {
            --ag-koobiq-row-background-color: var(--kbq-states-background-contrast-less-active);
        }
    }

    .ag-row.ag-row-focus {
        --ag-koobiq-row-background-color: var(--kbq-background-theme-less);

        &:hover {
            --ag-koobiq-row-background-color: var(--kbq-states-background-theme-less-hover);
        }

        &:active {
            --ag-koobiq-row-background-color: var(--kbq-states-background-theme-less-active);
        }
    }

    .ag-picker-field-wrapper {
        border-color: var(--ag-input-border-color);
    }

    .ag-tab {
        padding: calc(var(--ag-grid-size) * 1.5);
        transition: color 0.4s;
        flex: 1 1 auto;
    }

    .ag-tab-selected {
        color: var(--ag-koobiq-active-color);
    }

    .ag-menu {
        background-color: var(--kbq-background-card);
    }

    .ag-menu-header {
        background-color: var(--ag-control-panel-background-color);
        padding-top: 1px;
    }

    .ag-charts-settings-group-title-bar,
    .ag-charts-data-group-title-bar,
    .ag-charts-format-top-level-group-title-bar {
        padding: var(--ag-grid-size) calc(var(--ag-grid-size) * 2);
        line-height: calc(var(--ag-icon-size) + var(--ag-grid-size) - 2px);
    }

    .ag-chart-mini-thumbnail {
        background-color: var(--ag-background-color);
    }

    .ag-chart-settings-nav-bar {
        border-top: var(--ag-borders-secondary) var(--ag-secondary-border-color);
    }

    .ag-charts-format-top-level-group-toolbar {
        margin-top: var(--ag-grid-size);
    }

    .ag-charts-format-sub-level-group {
        border-left: dashed var(--kbq-size-border-width);
        border-left-color: var(--ag-border-color);
        padding-left: var(--ag-grid-size);
        margin-bottom: calc(var(--ag-grid-size) * 2);
    }

    .ag-charts-format-sub-level-group-title-bar {
        padding-top: 0;
        padding-bottom: 0;
        background: none;
    }

    .ag-charts-format-sub-level-group-container {
        padding-bottom: 0;
    }

    .ag-charts-format-sub-level-group-item:last-child {
        margin-bottom: 0;
    }

    &.ag-dnd-ghost {
        font-size: calc(var(--ag-font-size) - 1px);
    }

    .ag-side-buttons {
        width: calc(var(--ag-grid-size) * 5);
    }

    .ag-standard-button {
        appearance: none;
        -webkit-appearance: none;
        border-radius: var(--ag-border-radius);
        border: var(--kbq-size-border-width) solid;
        border-color: var(--ag-koobiq-active-color);
        color: var(--ag-koobiq-active-color);
        background-color: var(--ag-background-color);
        padding: var(--ag-grid-size) calc(var(--ag-grid-size) * 2);

        &:hover {
            border-color: var(--ag-koobiq-active-color);
            background-color: var(--ag-row-hover-color);
        }

        &:active {
            border-color: var(--ag-koobiq-active-color);
            background-color: var(--ag-koobiq-active-color);
            color: var(--ag-background-color);
        }

        &:disabled {
            color: var(--ag-disabled-foreground-color);
            background-color: var(--ag-input-disabled-background-color);
            border-color: var(--ag-input-disabled-border-color);
        }
    }

    .ag-column-drop-vertical {
        min-height: 75px;
    }

    .ag-column-drop-vertical-title-bar {
        padding: calc(var(--ag-grid-size) * 2);
        padding-bottom: 0px;
    }

    .ag-column-drop-vertical-empty-message {
        display: flex;
        align-items: center;
        border: dashed var(--kbq-size-border-width);
        border-color: var(--ag-border-color);
        margin: calc(var(--ag-grid-size) * 2);
        padding: calc(var(--ag-grid-size) * 2);
    }

    .ag-column-drop-empty-message {
        color: var(--ag-foreground-color);
        opacity: 0.75;
    }

    .ag-column-drop-cell-button {
        opacity: 0.5;

        &:hover {
            opacity: 0.75;
        }
    }

    .ag-chart-menu-close {
        background: var(--ag-background-color);
    }

    .ag-chart-menu-close .ag-icon {
        background: var(--ag-header-background-color);
        border: var(--kbq-size-border-width) solid var(--ag-border-color);
        border-right: none;
    }

    .ag-chart-menu-close:hover .ag-icon {
        border-color: var(--ag-koobiq-active-color);
    }

    .ag-header-cell-menu-button,
    .ag-side-button-button,
    .ag-tab,
    .ag-panel-title-bar-button,
    .ag-header-expand-icon,
    .ag-column-group-icons,
    .ag-set-filter-group-icons,
    .ag-group-expanded .ag-icon,
    .ag-group-contracted .ag-icon,
    .ag-chart-settings-prev,
    .ag-chart-settings-next,
    .ag-group-title-bar-icon,
    .ag-column-select-header-icon,
    .ag-floating-filter-button-button,
    .ag-filter-toolpanel-expand,
    .ag-chart-menu-icon,
    .ag-chart-menu-close {
        &:hover {
            color: var(--ag-koobiq-active-color);
        }
    }

    .ag-chart-settings-card-item.ag-not-selected:hover {
        opacity: 0.35;
    }

    .ag-filter-toolpanel-instance-filter {
        border: none;
        background-color: var(--ag-control-panel-background-color);
    }

    .ag-set-filter-list {
        padding-top: calc(var(--ag-grid-size) * 0.5);
        padding-bottom: calc(var(--ag-grid-size) * 0.5);
    }

    .ag-layout-auto-height,
    .ag-layout-print {
        .ag-center-cols-viewport,
        .ag-center-cols-container {
            min-height: 150px;
        }
    }

    .ag-overlay-no-rows-wrapper.ag-layout-auto-height {
        padding-top: 60px;
    }

    .ag-date-time-list-page-entry-is-current {
        background-color: var(--ag-koobiq-active-color);
    }

    .ag-advanced-filter-builder-button {
        padding: var(--ag-grid-size);
    }
}
